<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>호텔 로봇 서비스</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/main_style.css">
</head>
<body>

<div class="overlay">
    <div class="admin-login-area">
        {{^userName}}
            <div class="admin-login-icon position-absolute top-0 end-0 p-3">
                <button type="button"
                        class="btn btn-outline-light btn-sm rounded-circle"
                        data-bs-toggle="modal"
                        data-bs-target="#adminLoginModal"
                        data-bs-placement="bottom"
                        title="관리자 페이지"
                        id="adminLoginBtn">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        {{/userName}}
    </div>
    <div class="kiosk-container">
        <h1 class="text-center header-title">
            <i class="fas fa-robot me-3"></i>BELLBOT
        </h1>

        <p class="welcome-text">
            룸서비스부터 물품 배달까지, 언제나 곁에 있는 도우미 BELLBOT<br>
            필요한 서비스를 선택하시면 BELLBOT이 신속하게 도와드리겠습니다.
        </p>

        <div class="status-card">
            <h5 class="mb-3"><i class="fas fa-info-circle me-2"></i>로봇 상태</h5>
            <div class="robot-status">
                <span class="robot-name"><i class="fas fa-robot me-2"></i>서빙로봇 Alpha</span>
                <span class="status-badge available">사용가능</span>
            </div>
            <div class="robot-status">
                <span class="robot-name"><i class="fas fa-robot me-2"></i>배달로봇 Beta</span>
                <span class="status-badge available">사용가능</span>
            </div>
            <div class="robot-status">
                <span class="robot-name"><i class="fas fa-robot me-2"></i>청소로봇 Gamma</span>
                <span class="status-badge busy">서비스 중</span>
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-5 col-md-6">
                <div class="service-card">
                    <i class="fas fa-utensils service-icon"></i>
                    <h2 class="service-title">룸 서비스</h2>
                    <p class="service-description">
                        객실에서 편안하게 다양한 음식을<br>
                        즐겨보세요
                    </p>

                    <a href="/food-delivery" role="button" class="btn service-button">
                        <i class="fas fa-shopping-cart me-2"></i> 주문하기
                    </a>
                </div>
            </div>

            <div class="col-lg-5 col-md-6">
                <div class="service-card">
                    <i class="fas fa-box service-icon"></i>
                    <h2 class="service-title">물품 서비스</h2>
                    <p class="service-description">
                        수건, 어메니티, 청소용품 등<br>
                        필요한 물품을 신속하게 제공해드립니다
                    </p>

                    <a href="/article-delivery" role="button" class="btn service-button">
                        <i class="fas fa-hands-helping me-2"></i>물품 요청하기
                    </a>
                </div>
            </div>
        </div>

        <div class="status-card mt-4">
            <h5 class="mb-3"><i class="fas fa-lightbulb me-2"></i>이용 안내</h5>
            <div class="row">
                <div class="col-md-4 text-center mb-3">
                    <i class="fas fa-clock text-success mb-2" style="font-size: 2rem;"></i>
                    <h6>24시간 서비스</h6>
                    <small class="text-muted">언제든지 이용 가능합니다</small>
                </div>
                <div class="col-md-4 text-center mb-3">
                    <i class="fas fa-shield-alt text-success mb-2" style="font-size: 2rem;"></i>
                    <h6>안전한 배송</h6>
                    <small class="text-muted">무균 처리된 로봇으로 위생적 배송</small>
                </div>
                <div class="col-md-4 text-center mb-3">
                    <i class="fas fa-mobile-alt text-success mb-2" style="font-size: 2rem;"></i>
                    <h6>실시간 알림</h6>
                    <small class="text-muted">객실 전화로 도착 안내</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 관리자 로그인용 모달창 -->
<div class="modal fade" id="adminLoginModal" tabindex="-1" aria-labelledby="adminLoginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="adminLoginModalLabel">관리자 로그인</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <p>관리자 페이지 접근을 위해 ID와 Password를 입력해주세요.</p>
                <form id="adminLoginForm" onsubmit="event.preventDefault(); adminLogin();">

                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                        <input type="text" id="adminId" name="adminId" class="form-control" placeholder="관리자 ID" required>
                    </div>

                    <div class="input-group mb-3">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        <input type="password" id="adminPassword" name="adminPassword" class="form-control" placeholder="Password" required>
                    </div>

                    <small class="text-danger" id="loginErrorMsg" style="display: none;">ID 또는 Password가 올바르지 않습니다.</small>

                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
                <button type="submit" form="adminLoginForm" class="btn login-button">
                    <i class="fas fa-sign-in-alt"></i> 로그인
                </button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // 툴팁
    document.addEventListener('DOMContentLoaded', function () {
        const tooltip = new bootstrap.Tooltip(document.getElementById('adminLoginBtn'));
    });

    // 💡 관리자 로그인 처리 함수
    function adminLogin() {
        const id = document.getElementById('adminId').value.trim();
        const password = document.getElementById('adminPassword').value.trim();
        const errorMsg = document.getElementById('loginErrorMsg');

        // 입력 값 확인
        if (!id || !password) {
            errorMsg.textContent = "ID와 Password를 모두 입력해주세요.";
            errorMsg.style.display = 'block';
            return;
        } else {
            errorMsg.style.display = 'none';
        }


        const modalElement = document.getElementById('adminLoginModal');
        const modal = bootstrap.Modal.getInstance(modalElement) || new bootstrap.Modal(modalElement);
        // modal.hide();

        // 2. 서버로 로그인 정보 전송
        // **이 경로는 실제 백엔드 관리자 로그인 API 엔드포인트로 대체되어야 합니다.**
        fetch('/api/v1/auth/admin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                username: id,
                password: password
            })
        })
        .then(response => {
            if (response.ok) {
                // 3. 로그인 성공 시 처리 (HTTP 200 OK)
                //alert(`로그인 성공! 관리자 페이지로 이동합니다.`);
                // 관리자 페이지로 리다이렉션 (원하는 페이지: /admin/index)
                window.location.href = '/admin/index';
            } else {
                // 4. 로그인 실패 시 처리 (HTTP 401, 403 등)
                document.getElementById('loginErrorMsg').textContent = 'ID 또는 Password가 올바르지 않습니다.';
                document.getElementById('loginErrorMsg').style.display = 'block';

                modal.show(); // 실패 시 모달을 다시 열어 사용자에게 오류 메시지를 보여줌
            }
        })
        .catch(error => {
            console.error('로그인 중 오류 발생:', error);
            alert('네트워크 또는 서버 연결 오류가 발생했습니다.');
            modal.show();
        });
    }

    // [기존 함수들 유지]

    // 물품 서비스 선택 시 처리 로직 (기존 코드 유지)
    function selectItemService() {
        alert('물품 서비스를 선택하셨습니다.\n물품 선택 페이지로 이동합니다.');
        window.location.href = '/items/select';
    }

    // 로봇 상태 실시간 업데이트 (시뮬레이션) (기존 코드 유지)
    function updateRobotStatus() {
        const statusElements = document.querySelectorAll('.status-badge');
        statusElements.forEach((element, index) => {
            if (Math.random() > 0.8) {
                if (element.classList.contains('available')) {
                    element.classList.remove('available');
                    element.classList.add('busy');
                    element.textContent = '서비스 중';
                } else {
                    element.classList.remove('busy');
                    element.classList.add('available');
                    element.textContent = '사용가능';
                }
            }
        });
    }

    // 30초마다 로봇 상태 업데이트 (기존 코드 유지)
    setInterval(updateRobotStatus, 30000);
</script>

</body>
</html>